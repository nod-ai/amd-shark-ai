import torch

print("Torch version:", torch.__version__)
print("ROCm available:", torch.version.hip is not None)
print("CUDA available:", torch.cuda.is_available())
print("GPU count:", torch.cuda.device_count())

for i in range(torch.cuda.device_count()):
    print(f"\nTesting GPU {i}: {torch.cuda.get_device_name(i)}")
    device = torch.device(f"cuda:{i}")

    a = torch.randn(1024, 1024, device=device)
    b = torch.randn(1024, 1024, device=device)

    c = torch.matmul(a, b)
    torch.cuda.synchronize(device)

    print("Matmul OK on GPU", i, "| Result sum:", c.sum().item())
